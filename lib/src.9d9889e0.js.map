{"version":3,"sources":["types.coffee","task/types.coffee","lib.coffee","state-manager.coffee","task-list/index.coffee","hyper.coffee","ui-controls.coffee","task/elements.coffee","bundler/dev-bundler.coffee","bundler/index.coffee","task/index.coffee","figure-container.coffee","index.coffee"],"names":["assertShape","data","shape","subject","object","res","v","isRequired","TaskShape","T","multiPage","bool","Printer","Promise","colors","createHash","d3","fs","ipcRenderer","options","path","pixelsToMicrons","printFigureArea","printToImage","printToPDF","remote","sleep","waitForUserInput","require","getGlobal","dpi","log","resolve","reject","once","send","fn","setTimeout","px","Math","ceil","webview","opts","controls","el","height","oldDisplay","pageSize","scaleFactor","wc","width","document","getElementsByClassName","styles","printBackground","marginsType","console","style","transform","transformOrigin","display","webContents","getCurrentWindow","e","rect","format","quality","x","y","capturePage","image","d","includes","toJPEG","toPNG","task","buf","dir","ext","outfile","querySelector","getBoundingClientRect","dirname","existsSync","mkdirSync","extname","getCurrentWebContents","slice","writeFileSync","constructor","base","arguments","cliOptions","buildDir","tasks","funcOrString","func","h","isAbsolute","join","process","cwd","update","digest","push","code","helpers","hash","run","module","exports","AppStateContext","AppStateManager","getSpecs","nameForTask","spawn","boundMethodCheck","instance","Constructor","Error","window","then","name","replace","Component","props","appState","shouldListTasks","bind","selectedTask","defineTasks","openEditor","selectTask","updateState","toggleDevTools","componentDidMount","state","taskLists","length","i","j","len","len1","ref","selectedTaskHash","taskList","p","spec","specs","map","infile","$set","env","EDITOR","detached","render","methods","value","hasTaskList","Provider","children","newState","setState","devToolsEnabled","toolbarEnabled","zoomLevel","win","openDevTools","on","event","zoom","addEventListener","isOpen","detail","TaskList","TaskListItem","TaskListSection","sharedStart","array","A","L","a1","a2","concat","sort","charAt","substring","onClick","context","displayName","href","contextType","call","arr","prefix","runners","BackButton","CurrentTaskName","DevToolsButton","EditorButton","MinimalUIControls","PrintButton","ToolButton","ToolbarToggleButton","UIControls","Button","small","minimal","disabled","rightIcon","icon","intent","Intent","PRIMARY","$toggle","className","ErrorBoundary","TaskElement","TaskStylesheet","React","error","errorInfo","componentDidCatch","whiteSpace","toString","componentStack","runTask","error1","callback","componentDidUpdate","prevProps","defaultProps","type","mountStyles","appendChild","createTextNode","runBundler","file","bundler","hmr","outDir","publicUrl","watch","cache","cacheDir","contentHash","minify","scopeHoist","target","https","logLevel","sourceMaps","detailedReport","bundleNodeModules","Bundler","bundle","err","debug","printLine","printToStdout","obj","line","String","JSON","stringify","child","results","stdout","inFile","TaskRenderer","timeout","startBundler","onBundlingStarted","onBundlingFinished","Spinner","codeFile","dn","pid","kill","compiledCode","cssFile","siblingBundlesMap","get","readFileSync","componentWillUnmount","stop","propTypes","FigureContainer","marginTop","z","padding","key","integer","App","AppMain","FocusStyleManager","onlyShowFocusOnTabs","renderMain"],"mappings":"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","file":"src.9d9889e0.js","sourceRoot":"../src","sourcesContent":["var assertShape;\n\nimport {\n  assertPropTypes\n} from 'check-prop-types';\n\nassertShape = function(data, shape, subject = \"data\", object = \"application\") {\n  var res;\n  res = assertPropTypes({\n    v: shape.isRequired\n  }, {\n    v: data\n  }, subject, object);\n  if (res != null) {\n    throw res;\n  }\n};\n\nexport {\n  assertShape\n};\n","var TaskShape;\n\nimport T from 'prop-types';\n\nTaskShape = T.shape({\n  multiPage: T.bool.isRequired\n});\n\nexport {\n  TaskShape\n};\n","var Printer, Promise, colors, createHash, d3, fs, ipcRenderer, options, path, pixelsToMicrons, printFigureArea, printToImage, printToPDF, remote, sleep, waitForUserInput;\n\nPromise = require('bluebird');\n\nfs = require('fs');\n\n({remote, ipcRenderer} = require('electron'));\n\n({createHash} = require('crypto'));\n\npath = require('path');\n\nd3 = require('d3-selection');\n\ncolors = require('colors/safe');\n\nimport styles from './main.styl';\n\nimport {\n  assertShape\n} from '~/types';\n\nimport {\n  TaskShape\n} from './task/types';\n\noptions = remote.getGlobal('options' || {});\n\nif (options.dpi == null) {\n  options.dpi = 96;\n}\n\noptions.log = false;\n\nwaitForUserInput = function(data) {\n  return new Promise(function(resolve, reject) {\n    ipcRenderer.once('done-waiting', function() {\n      return resolve(data);\n    });\n    return ipcRenderer.send('wait-for-input');\n  });\n};\n\nsleep = function(data) {\n  return new Promise(function(resolve, reject) {\n    var fn;\n    fn = function() {\n      return resolve(data);\n    };\n    return setTimeout(fn, 1000);\n  });\n};\n\npixelsToMicrons = function(px) {\n  return Math.ceil(px / 96.0 * 25400);\n};\n\nprintToPDF = function(webview, opts) {\n  return new Promise(function(resolve, reject) {\n    /*\n    Print the webview to the callback\n    */\n    var controls, el, height, oldDisplay, pageSize, scaleFactor, wc, width;\n    el = document.getElementsByClassName(styles[\"figure-container-inner\"])[0];\n    controls = document.getElementsByClassName(styles[\"ui-controls\"])[0];\n    // pageSize can be A3, A4, A5, Legal, Letter, Tabloid or an Object\n    // containing height and width in microns.\n    // (https://electronjs.org/docs/api/web-contents)\n    ({pageSize, width, height, scaleFactor} = opts);\n    if (pageSize == null) {\n      pageSize = {\n        height: pixelsToMicrons(height * scaleFactor),\n        width: pixelsToMicrons(width * scaleFactor)\n      };\n    }\n    opts = {\n      printBackground: true,\n      marginsType: 1,\n      pageSize\n    };\n    console.log(opts);\n    el.style.transform = `scale(${scaleFactor})`;\n    el.style.transformOrigin = \"top left\";\n    oldDisplay = controls.style.display;\n    controls.style.display = \"none\";\n    ({\n      webContents: wc\n    } = remote.getCurrentWindow());\n    return wc.printToPDF(opts, (e, data) => {\n      if (e != null) {\n        reject(e);\n      }\n      resolve(data);\n      el.style.transform = null;\n      el.style.transformOrigin = null;\n      return controls.style.display = oldDisplay;\n    });\n  });\n};\n\nprintToImage = function(webview, opts) {\n  return new Promise(function(resolve, reject) {\n    var height, rect, width;\n    /*\n    Print the webview to the callback\n    */\n    if (opts.format == null) {\n      opts.format = 'png';\n    }\n    if (opts.scaleFactor == null) {\n      opts.scaleFactor = 1.8;\n    }\n    if (opts.quality == null) {\n      opts.quality = 90;\n    }\n    ({width, height} = opts);\n    width *= opts.scaleFactor;\n    height *= opts.scaleFactor;\n    rect = {\n      x: 0,\n      y: 30,\n      width,\n      height\n    };\n    console.log(rect);\n    return webview.capturePage(rect, function(image) {\n      var d;\n      if (typeof e !== \"undefined\" && e !== null) {\n        reject(e);\n      }\n      if (['jpeg', 'jpg'].includes(opts.format)) {\n        d = image.toJPEG(rect, opts.quality);\n      } else {\n        d = image.toPNG(opts.scaleFactor);\n      }\n      return resolve(d);\n    });\n  });\n};\n\nprintFigureArea = async function(task) {\n  var buf, dir, el, ext, height, opts, outfile, pageSize, scaleFactor, wc, width;\n  /*\n   * Function to print webpage\n   */\n  assertShape(task, TaskShape);\n  console.log(task);\n  opts = task.opts || {};\n  ({scaleFactor} = opts);\n  if (scaleFactor == null) {\n    scaleFactor = 1;\n  }\n  el = document.querySelector(`.${styles['figure-container-inner']}>*:first-child`);\n  ({width, height} = el.getBoundingClientRect());\n  opts = {width, height, scaleFactor};\n  ({outfile} = task);\n  dir = path.dirname(outfile);\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir);\n  }\n  console.log(`Printing to ${outfile}`);\n  ext = path.extname(outfile);\n  wc = remote.getCurrentWebContents();\n  if (['.jpg', '.jpeg', '.png'].includes(ext)) {\n    opts.format = ext.slice(1);\n    buf = (await printToImage(wc, opts));\n  } else {\n    // Set pageSize from task\n    ({pageSize} = task.opts);\n    opts.pageSize = pageSize;\n    buf = (await printToPDF(wc, opts));\n  }\n  console.log(`${outfile}`);\n  fs.writeFileSync(outfile, buf);\n  return console.log(\"Finished task\");\n};\n\n// Initialize renderer\nPrinter = class Printer {\n  constructor(options = {}) {\n    var base;\n    /*\n    Setup a rendering object\n    */\n    console.log(arguments[0]);\n    this.cliOptions = {};\n    console.log(\"Started renderer\");\n    this.options = options;\n    if ((base = this.options).buildDir == null) {\n      base.buildDir = '';\n    }\n    this.tasks = [];\n  }\n\n  task(fn, funcOrString, opts = {}) {\n    var func, h;\n    /*\n    Add a task\n    */\n    if (opts.dpi == null) {\n      opts.dpi = 300;\n    }\n    // Check if we've got a function or string\n    if (typeof funcOrString === 'function') {\n      throw \"We only support strings now, because we run things in a webview\";\n      func = funcOrString;\n    } else {\n      // Require relative to parent module,\n      // but do it later so errors can be accurately\n      // traced\n      if (!path.isAbsolute(funcOrString)) {\n        func = path.join(process.cwd(), funcOrString);\n      } else {\n        func = funcOrString;\n      }\n    }\n    //f = require fn\n    //f(el, cb)\n    console.log(this.options);\n    // Apply build directory\n    if (fn != null) {\n      if (!path.isAbsolute(fn)) {\n        fn = path.join(this.options.buildDir, fn);\n      }\n    } else {\n      fn = \"\";\n    }\n    h = createHash('md5').update(fn).digest('hex');\n    this.tasks.push({\n      outfile: fn,\n      code: func,\n      helpers: this.options.helpers,\n      hash: h,\n      multiPage: opts.multiPage,\n      opts: opts\n    });\n    return this;\n  }\n\n  run() {}\n\n};\n\n// Progress through list of figures, print\n// each one to file\n// TODO: fix this mode of operation\n// __runTask = (t)->\n//   console.log \"#{t.code} â‡’ #{t.outfile}\"\n//   p = generateFigure(t)\n\n//   if options.waitForUser\n//     p = p.then waitForUserInput\n\n//   p.then printFigureArea\n//     .catch (e)->console.log('Error: '+e)\n\n// Promise\n//   .map @tasks, __runTask, concurrency: 1\nmodule.exports = {Printer, printFigureArea};\n","var AppStateContext, AppStateManager, getSpecs, nameForTask, spawn,\n  boundMethodCheck = function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } };\n\nimport {\n  Component,\n  createContext\n} from 'react';\n\nimport h from 'react-hyperscript';\n\nimport update from 'immutability-helper';\n\nimport {\n  remote,\n  ipcRenderer\n} from 'electron';\n\nimport Promise from 'bluebird';\n\n({spawn} = require('child_process'));\n\nimport {\n  parse\n} from 'path';\n\nimport 'devtools-detect';\n\nimport {\n  // This is awful\n  Printer,\n  printFigureArea\n} from \"./lib.coffee\";\n\nwindow.Printer = Printer;\n\nAppStateContext = createContext({});\n\ngetSpecs = function(d) {\n  var res;\n  res = require(d);\n  return Promise.resolve(res).then(function(v) {\n    v.name = d;\n    return v;\n  });\n};\n\nnameForTask = function(task) {\n  var name, outfile;\n  ({name, outfile} = task);\n  if (name == null) {\n    ({name} = parse(outfile));\n  }\n  return name.replace(/[-_]/g, \" \");\n};\n\nAppStateManager = class AppStateManager extends Component {\n  constructor(props) {\n    var appState, options;\n    super(props);\n    this.shouldListTasks = this.shouldListTasks.bind(this);\n    this.selectedTask = this.selectedTask.bind(this);\n    this.defineTasks = this.defineTasks.bind(this);\n    this.openEditor = this.openEditor.bind(this);\n    this.selectTask = this.selectTask.bind(this);\n    this.updateState = this.updateState.bind(this);\n    this.toggleDevTools = this.toggleDevTools.bind(this);\n    this.componentDidMount = this.componentDidMount.bind(this);\n    this.printFigureArea = this.printFigureArea.bind(this);\n    options = remote.getGlobal('options');\n    appState = remote.getGlobal('appState');\n    this.state = {\n      taskLists: null,\n      // We should improve this\n      ...options,\n      ...appState\n    };\n    this.defineTasks(options);\n  }\n\n  shouldListTasks() {\n    var taskLists;\n    boundMethodCheck(this, AppStateManager);\n    ({taskLists} = this.state);\n    if (taskLists == null) {\n      return false;\n    }\n    if (taskLists.length === 1) {\n      return taskLists[0].tasks.length !== 1;\n    }\n    return true;\n  }\n\n  selectedTask() {\n    var i, j, len, len1, ref, selectedTaskHash, task, taskList, taskLists;\n    boundMethodCheck(this, AppStateManager);\n    ({selectedTaskHash, taskLists} = this.state);\n    if (taskLists == null) {\n      return null;\n    }\n    if (!this.shouldListTasks()) {\n      return taskLists[0].tasks[0];\n    }\n    for (i = 0, len = taskLists.length; i < len; i++) {\n      taskList = taskLists[i];\n      ref = taskList.tasks;\n      for (j = 0, len1 = ref.length; j < len1; j++) {\n        task = ref[j];\n        if (task.hash === selectedTaskHash) {\n          return task;\n        }\n      }\n    }\n    return null;\n  }\n\n  async defineTasks(options) {\n    var multiPage, p, pageSize, res, spec, specs;\n    boundMethodCheck(this, AppStateManager);\n    ({specs} = options);\n    // These should really be applied separately to each part\n    ({multiPage, pageSize} = this.state);\n    // If we are in spec mode\n    if (specs != null) {\n      p = Promise.map(specs, getSpecs);\n    } else {\n      spec = new Printer;\n      spec.task(options.outfile, options.infile, {multiPage, pageSize});\n      p = Promise.resolve([spec]);\n    }\n    res = (await p);\n    return this.updateState({\n      taskLists: {\n        $set: res\n      }\n    });\n  }\n\n  openEditor() {\n    var task;\n    boundMethodCheck(this, AppStateManager);\n    task = this.selectedTask();\n    if (task == null) {\n      return;\n    }\n    return spawn(process.env.EDITOR, [task.code], {\n      detached: true\n    });\n  }\n\n  selectTask(task) {\n    var hash;\n    boundMethodCheck(this, AppStateManager);\n    hash = null;\n    if (task != null) {\n      hash = task.hash;\n    }\n    return this.updateState({\n      selectedTaskHash: {\n        $set: hash\n      }\n    });\n  }\n\n  render() {\n    var methods, selectedTask, value;\n    methods = (() => {\n      var openEditor, selectTask, toggleDevTools;\n      return ({toggleDevTools, openEditor, selectTask} = this);\n    })();\n    selectedTask = this.selectedTask();\n    value = {\n      update: this.updateState,\n      printFigureArea: this.printFigureArea,\n      hasTaskList: this.shouldListTasks(),\n      nameForTask,\n      ...methods,\n      ...this.state,\n      selectedTask\n    };\n    return h(AppStateContext.Provider, {value}, this.props.children);\n  }\n\n  updateState(spec) {\n    var appState, newState;\n    boundMethodCheck(this, AppStateManager);\n    newState = update(this.state, spec);\n    this.setState(newState);\n    // forward state to main process\n    appState = (function() {\n      var devToolsEnabled, selectedTaskHash, toolbarEnabled, zoomLevel;\n      return ({toolbarEnabled, selectedTaskHash, devToolsEnabled, zoomLevel} = newState);\n    })();\n    return ipcRenderer.send('update-state', appState);\n  }\n\n  toggleDevTools() {\n    var win;\n    boundMethodCheck(this, AppStateManager);\n    this.updateState({\n      devToolsEnabled: {\n        $set: true\n      }\n    });\n    ipcRenderer.send('dev-tools');\n    win = remote.getCurrentWindow();\n    return win.openDevTools();\n  }\n\n  componentDidMount() {\n    boundMethodCheck(this, AppStateManager);\n    ipcRenderer.on('show-toolbar', (event, toolbarEnabled) => {\n      return this.updateState({\n        toolbarEnabled: {\n          $set: toolbarEnabled\n        }\n      });\n    });\n    ipcRenderer.on('zoom', (event, zoom) => {\n      return this.updateState({\n        zoomLevel: {\n          $set: zoom\n        }\n      });\n    });\n    ipcRenderer.on('update-state', (event, state) => {\n      console.log(\"Updating state from main process\");\n      return this.setState({...state});\n    });\n    return window.addEventListener('devtoolschange', (event) => {\n      var isOpen;\n      ({isOpen} = event.detail);\n      return this.updateState({\n        devToolsEnabled: {\n          $set: isOpen\n        }\n      });\n    });\n  }\n\n  printFigureArea() {\n    var task;\n    boundMethodCheck(this, AppStateManager);\n    task = this.selectedTask();\n    return printFigureArea(task);\n  }\n\n};\n\nexport {\n  AppStateContext,\n  AppStateManager\n};\n","var TaskList, TaskListItem, TaskListSection, h, sharedStart,\n  boundMethodCheck = function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } };\n\nimport {\n  Component\n} from 'react';\n\nimport {\n  AppStateContext\n} from '../state-manager';\n\nimport {\n  hyperStyled\n} from '@macrostrat/hyper';\n\nimport styles from './styles.styl';\n\nh = hyperStyled(styles);\n\nsharedStart = function(array) {\n  var A, L, a1, a2, i;\n  // From\n  // http://stackoverflow.com/questions/1916218/\n  //       find-the-longest-common-starting-substring-in-a-set-of-strings\n  A = array.concat().sort();\n  a1 = A[0];\n  a2 = A[A.length - 1];\n  L = a1.length;\n  i = 0;\n  while (i < L && a1.charAt(i) === a2.charAt(i)) {\n    i++;\n  }\n  return a1.substring(0, i);\n};\n\nTaskListItem = (function() {\n  class TaskListItem extends Component {\n    constructor() {\n      super(...arguments);\n      this.onClick = this.onClick.bind(this);\n    }\n\n    onClick() {\n      var task;\n      boundMethodCheck(this, TaskListItem);\n      ({task} = this.props);\n      return this.context.selectTask(task);\n    }\n\n    render() {\n      var displayName, task;\n      ({task, displayName} = this.props);\n      return h('li', null, h('a', {\n        href: `#${task.hash}`,\n        onClick: this.onClick\n      }, displayName));\n    }\n\n  };\n\n  TaskListItem.contextType = AppStateContext;\n\n  return TaskListItem;\n\n}).call(this);\n\nTaskListSection = function(props) {\n  var arr, name, prefix, tasks;\n  ({tasks, name} = props);\n  if (name == null) {\n    name = \"Tasks\";\n  }\n  // Render spec list from runner\n  // Find shared starting substring\n  arr = tasks.map(function(d) {\n    return d.outfile;\n  });\n  arr.push(name);\n  prefix = sharedStart(arr);\n  return h('div.task-list', [\n    h('h2',\n    [h('span.prefix',\n    prefix),\n    h('span.name',\n    name.slice(prefix.length))]),\n    h('ul',\n    tasks.map(function(task) {\n      var displayName;\n      displayName = task.outfile.slice(prefix.length);\n      return h(TaskListItem,\n    {displayName,\n    task});\n    }))\n  ]);\n};\n\nTaskList = function({runners}) {\n  return h('div', runners.map(function(d) {\n    return h(TaskListSection, d);\n  }));\n};\n\nexport {\n  TaskList,\n  TaskListItem\n};\n","var h;\n\nimport {\n  hyperStyled\n} from '@macrostrat/hyper';\n\nimport styles from '~/main.styl';\n\nh = hyperStyled(styles);\n\nexport default h;\n","var BackButton, CurrentTaskName, DevToolsButton, EditorButton, MinimalUIControls, PrintButton, ToolButton, ToolbarToggleButton, UIControls;\n\nimport {\n  AnchorButton,\n  Button,\n  Intent\n} from '@blueprintjs/core';\n\nimport {\n  Component,\n  useContext\n} from 'react';\n\nimport {\n  AppStateContext\n} from './state-manager';\n\nimport {\n  TaskListItem\n} from './task-list';\n\nimport h from '~/hyper';\n\nToolButton = function(props) {\n  return h(Button, {\n    small: true,\n    minimal: true,\n    ...props\n  });\n};\n\nDevToolsButton = (function() {\n  class DevToolsButton extends Component {\n    render() {\n      var disabled, onClick;\n      onClick = this.context.toggleDevTools;\n      disabled = this.context.devToolsEnabled;\n      return h(ToolButton, {\n        onClick,\n        disabled,\n        rightIcon: 'code'\n      }, \"DevTools\");\n    }\n\n  };\n\n  DevToolsButton.contextType = AppStateContext;\n\n  return DevToolsButton;\n\n}).call(this);\n\nBackButton = (function() {\n  class BackButton extends Component {\n    render() {\n      var onClick;\n      if (this.context.selectedTask == null) {\n        return null;\n      }\n      if (!this.context.hasTaskList) {\n        return null;\n      }\n      onClick = () => {\n        return this.context.selectTask(null);\n      };\n      return h(ToolButton, {\n        icon: 'caret-left',\n        onClick\n      }, 'Back to list');\n    }\n\n  };\n\n  BackButton.contextType = AppStateContext;\n\n  return BackButton;\n\n}).call(this);\n\nPrintButton = (function() {\n  class PrintButton extends Component {\n    render() {\n      var onClick, printFigureArea;\n      ({printFigureArea} = this.context);\n      onClick = function() {\n        return printFigureArea();\n      };\n      return h(ToolButton, {\n        rightIcon: 'print',\n        onClick,\n        intent: Intent.PRIMARY\n      }, 'Print');\n    }\n\n  };\n\n  PrintButton.contextType = AppStateContext;\n\n  return PrintButton;\n\n}).call(this);\n\nEditorButton = (function() {\n  class EditorButton extends Component {\n    render() {\n      return h(ToolButton, {\n        icon: 'edit',\n        onClick: this.context.openEditor\n      }, 'Open editor');\n    }\n\n  };\n\n  EditorButton.contextType = AppStateContext;\n\n  return EditorButton;\n\n}).call(this);\n\nCurrentTaskName = function(props) {\n  var nameForTask, selectedTask;\n  ({selectedTask, nameForTask} = useContext(AppStateContext));\n  if (selectedTask == null) {\n    return null;\n  }\n  return h('h1.task-name.bp3-text', nameForTask(selectedTask));\n};\n\nToolbarToggleButton = function(props) {\n  var icon, intent, onClick, toolbarEnabled, update;\n  ({update, toolbarEnabled} = useContext(AppStateContext));\n  onClick = function() {\n    return update({\n      $toggle: ['toolbarEnabled']\n    });\n  };\n  intent = null;\n  icon = 'menu';\n  if (toolbarEnabled) {\n    icon = 'eye-off';\n  }\n  return h(ToolButton, {\n    minimal: true,\n    icon,\n    intent,\n    onClick,\n    className: 'toolbar-toggle-button',\n    ...props\n  });\n};\n\nMinimalUIControls = function() {\n  return h('div.ui-controls-hidden', [\n    h(ToolbarToggleButton,\n    {\n      small: false\n    })\n  ]);\n};\n\nUIControls = (function() {\n  class UIControls extends Component {\n    render() {\n      var hasTaskList, selectedTask, toolbarEnabled;\n      ({hasTaskList, selectedTask, toolbarEnabled} = this.context);\n      if (!toolbarEnabled) {\n        return h(MinimalUIControls);\n      }\n      return h('div.ui-controls', [h('div.left-buttons', [h(BackButton), h(CurrentTaskName)]), h('div.right-buttons', [h(DevToolsButton), h.if(selectedTask != null)([h(PrintButton)]), h('span.separator'), h(ToolbarToggleButton)])]);\n    }\n\n  };\n\n  UIControls.contextType = AppStateContext;\n\n  return UIControls;\n\n}).call(this);\n\nexport {\n  UIControls\n};\n","var ErrorBoundary, TaskElement, TaskStylesheet,\n  boundMethodCheck = function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } };\n\nimport React, {\n  Component\n} from 'react';\n\nimport h from 'react-hyperscript';\n\nimport {\n  findDOMNode,\n  render\n} from 'react-dom';\n\nErrorBoundary = class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null,\n      errorInfo: null\n    };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    // Catch errors in any components below and re-render with error message\n    return this.setState({\n      error: error,\n      errorInfo: errorInfo\n    });\n  }\n\n  render() {\n    if (this.state.errorInfo) {\n      // Error path\n      return <div>\n          <h2>Something went wrong.</h2>\n          <details style={{\n          whiteSpace: 'pre-wrap'\n        }}>\n            {this.state.error && this.state.error.toString()}\n            <br />\n            {this.state.errorInfo.componentStack}\n          </details>\n        </div>;\n    }\n    return this.props.children;\n  }\n\n};\n\nTaskElement = (function() {\n  class TaskElement extends Component {\n    constructor(props) {\n      super(props);\n      this.runTask = this.runTask.bind(this);\n    }\n\n    render() {\n      var children, code;\n      ({code} = this.props);\n      if (code == null) {\n        return null;\n      }\n      try {\n        console.log(\"Rendering task\");\n        children = h(ErrorBoundary, [h(code)]);\n        return h('div', {children});\n      } catch (error1) {\n        return h('div');\n      }\n    }\n\n    runTask() {\n      var callback, code, el;\n      boundMethodCheck(this, TaskElement);\n      ({code, callback} = this.props);\n      if (code == null) {\n        return;\n      }\n      return;\n      console.log(\"Running code from bundle\");\n      // React components are handled directly\n      //return\n      // Here is where we would accept different\n      // types of components\n      if (callback == null) {\n        callback = function() {};\n      }\n      el = findDOMNode(this);\n      return render(h(code), el, callback);\n    }\n\n    componentDidMount() {\n      return this.runTask();\n    }\n\n    componentDidUpdate(prevProps) {\n      //return if prevProps.code == @props.code\n      console.log(\"Code was updated\");\n      return this.runTask();\n    }\n\n  };\n\n  TaskElement.defaultProps = {\n    code: null,\n    callback: null\n  };\n\n  return TaskElement;\n\n}).call(this);\n\nTaskStylesheet = class TaskStylesheet extends Component {\n  render() {\n    return h('style', {\n      type: 'text/css'\n    });\n  }\n\n  mountStyles() {\n    var el, styles;\n    el = findDOMNode(this);\n    ({styles} = this.props);\n    if (styles == null) {\n      return;\n    }\n    return el.appendChild(document.createTextNode(styles));\n  }\n\n  componentDidMount() {\n    return this.mountStyles();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.styles === this.props.styles) {\n      return;\n    }\n    return this.mountStyles();\n  }\n\n};\n\nexport {\n  TaskElement,\n  TaskStylesheet\n};\n","\n// This file houses configuration for the Parcel bundler\n// that packages files for each task.\n\nvar runBundler;\n\nimport Bundler from 'parcel-bundler';\n\n//  Bundler options\nrunBundler = function(file, opts) {\n  var bundler, options;\n  options = {\n    hmr: false,\n    outDir: 'dist', // The out directory to put the build files in, defaults to dist\n    publicUrl: './', // The url to server on, defaults to dist\n    watch: true, // whether to watch the files and rebuild them on change, defaults to process.env.NODE_ENV !== 'production'\n    cache: true, // Enabled or disables caching, defaults to true\n    cacheDir: '.cache', // The directory cache gets put in, defaults to .cache\n    contentHash: true, // Disable content hash from being included on the filename\n    minify: false, // Minify files, enabled if process.env.NODE_ENV === 'production'\n    scopeHoist: false, // turn on experimental scope hoisting/tree shaking flag, for smaller production bundles\n    target: 'electron', // browser/node/electron, defaults to browser\n    https: false, // Serve files over https or http, defaults to false\n    logLevel: 3, // 3 = log everything, 2 = log warnings & errors, 1 = log errors\n    //hmrPort: 0, # The port the HMR socket runs on, defaults to a random free port (0 in node.js resolves to a random free port)\n    sourceMaps: true, // Enable or disable sourcemaps, defaults to enabled (not supported in minified builds yet)\n    //hmrHostname: '', # A hostname for hot module reload, default to ''\n    detailedReport: true, // Prints a detailed report of the bundles, assets, filesizes and times, defaults to false, reports are only printed if watch is disabled\n    bundleNodeModules: false,\n    ...opts\n  };\n  bundler = new Bundler(file, options);\n  bundler.bundle().catch((err) => {\n    return console.error(err);\n  });\n  return bundler;\n};\n\nexport default runBundler;\n","var debug, printLine, printToStdout, runBundler;\n\nimport {\n  spawn\n} from 'child_process';\n\nimport {\n  ipcRenderer,\n  remote\n} from 'electron';\n\nimport path from 'path';\n\nimport createBundler from './dev-bundler';\n\ndebug = false;\n\nprintLine = function(obj) {\n  line;\n  var line;\n  // Convert to string if needed\n  if (typeof obj === 'string' || obj instanceof String) {\n    line = obj;\n  } else {\n    line = JSON.stringify(obj);\n  }\n  return ipcRenderer.send('bundle-log', line);\n};\n\nprintToStdout = async function(child) {\n  var data, line, ref, results;\n  ref = child.stdout;\n  results = [];\n  for await (data of ref) {\n    line = data.toString('utf8');\n    results.push(printLine(line));\n  }\n  return results;\n};\n\nrunBundler = function(inFile, options = {}) {\n  var bundler;\n  // proc.on 'message', (bundle)=>\n  //   if (debug) printLine(bundle)\n  bundler = createBundler(inFile, options);\n  return bundler;\n};\n\nexport {\n  runBundler\n};\n","var TaskRenderer, fs, path, runBundler, sleep,\n  boundMethodCheck = function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } };\n\nimport {\n  Component\n} from 'react';\n\nimport h from '~/hyper';\n\nimport {\n  Spinner\n} from '@blueprintjs/core';\n\nimport {\n  TaskElement,\n  TaskStylesheet\n} from './elements';\n\nimport {\n  TaskShape\n} from './types';\n\nimport requireString from 'require-from-string';\n\npath = require('path');\n\nfs = require('fs');\n\n({runBundler} = require('../bundler'));\n\nsleep = function(timeout = 1000) {\n  return new Promise(function(resolve, reject) {\n    var fn;\n    fn = function() {\n      return resolve();\n    };\n    return setTimeout(fn, timeout);\n  });\n};\n\nTaskRenderer = (function() {\n  class TaskRenderer extends Component {\n    constructor(props) {\n      super(props);\n      this.startBundler = this.startBundler.bind(this);\n      this.onBundlingStarted = this.onBundlingStarted.bind(this);\n      this.onBundlingFinished = this.onBundlingFinished.bind(this);\n      this.bundler = null;\n      this.state = {\n        code: null,\n        styles: null\n      };\n    }\n\n    render() {\n      var code, styles;\n      ({code, styles} = this.state);\n      if ((code == null) && (styles == null)) {\n        return h('div.progress', [h(Spinner), h('p', \"Bundling code\")]);\n      }\n      return h('div.figure-container-inner', [h(TaskStylesheet, {styles}), h(TaskElement, {code})]);\n    }\n\n    startBundler() {\n      /*\n       * This is the function that actually runs a discrete task\n       */\n      var cacheDir, codeFile, dn, outDir, task;\n      boundMethodCheck(this, TaskRenderer);\n      ({task} = this.props);\n      console.log(\"Running task\");\n      ({\n        code: codeFile\n      } = task); // The file that has the code in it...\n      dn = path.dirname(path.resolve(codeFile));\n      cacheDir = path.join(dn, '.cache');\n      outDir = path.join(cacheDir, 'build');\n      this.bundler = runBundler(codeFile, {\n        outDir,\n        cacheDir,\n        cache: true,\n        contentHash: true\n      });\n      console.log(`Running bundler process with PID ${this.bundler.pid}`);\n      process.on('exit', () => {\n        return this.bundler.kill();\n      });\n      this.bundler.on('buildStart', (bundle) => {\n        return this.onBundlingStarted(bundle);\n      });\n      return this.bundler.on('bundled', (bundle) => {\n        return this.onBundlingFinished(bundle, outDir);\n      });\n    }\n\n    onBundlingStarted(bundle) {\n      boundMethodCheck(this, TaskRenderer);\n      console.log(\"Bundling started\");\n      return this.setState({\n        code: null,\n        styles: null\n      });\n    }\n\n    async onBundlingFinished(bundle, outDir) {\n      var code, compiledCode, cssFile, styles, v;\n      boundMethodCheck(this, TaskRenderer);\n      console.log(bundle);\n      console.log(\"Bundling done\");\n      console.log(\"Sleeping for 500 ms\");\n      await sleep(500);\n      if (bundle.type !== 'js') {\n        throw \"Only javascript output is supported (for now)\";\n      }\n      cssFile = bundle.siblingBundlesMap.get(\"css\").name;\n      // Get css and javascript\n      styles = null;\n      if (fs.existsSync(cssFile)) {\n        styles = fs.readFileSync(cssFile, 'utf-8');\n      }\n      compiledCode = bundle.name;\n      console.log(`Requiring compiled code from ${bundle.name}`);\n      v = require.resolve(compiledCode);\n      delete require.cache[v];\n      code = require(v);\n      return this.setState({code, styles});\n    }\n\n    componentDidMount() {\n      var task;\n      ({task} = this.props);\n      if (task == null) {\n        return;\n      }\n      return this.startBundler(task);\n    }\n\n    componentDidUpdate(prevProps) {\n      var task;\n      ({task} = this.props);\n      if (prevProps.task === task) {\n\n      }\n    }\n\n    //@startBundler task\n    componentWillUnmount() {\n      if (this.bundler == null) {\n        return;\n      }\n      return this.bundler.stop();\n    }\n\n  };\n\n  TaskRenderer.propTypes = {\n    task: TaskShape.isRequired\n  };\n\n  return TaskRenderer;\n\n}).call(this);\n\nexport {\n  TaskRenderer,\n  TaskShape\n};\n","var FigureContainer;\n\nimport h from '~/hyper';\n\nimport {\n  Component\n} from 'react';\n\nimport T from 'prop-types';\n\nimport {\n  TaskRenderer,\n  TaskShape\n} from './task';\n\nFigureContainer = (function() {\n  class FigureContainer extends Component {\n    render() {\n      var height, marginTop, multiPage, style, task, z, zoomLevel;\n      ({zoomLevel, task, marginTop} = this.props);\n      // We shouldn't have this nested structure, it's confusing\n      ({multiPage} = task.opts);\n      if (multiPage == null) {\n        multiPage = false;\n      }\n      height = multiPage ? null : \"100vh\";\n      z = zoomLevel === 1 ? null : `scale(${zoomLevel})`;\n      style = {\n        transform: z,\n        transformOrigin: \"0px 0px\",\n        padding: `${20 / zoomLevel}px`\n      };\n      return h('div.figure-container-outer', {\n        style: {height, marginTop}\n      }, [\n        h('div.figure-container',\n        {style},\n        [\n          h.if(task != null)(TaskRenderer,\n          {\n            task,\n            key: task\n          })\n        ])\n      ]);\n    }\n\n  };\n\n  FigureContainer.defaultProps = {\n    zoomLevel: 1,\n    marginTop: null\n  };\n\n  FigureContainer.propTypes = {\n    task: TaskShape,\n    marginTop: T.integer\n  };\n\n  return FigureContainer;\n\n}).call(this);\n\nexport {\n  FigureContainer\n};\n","var App, AppMain, el;\n\nimport \"@babel/polyfill\";\n\nimport {\n  FocusStyleManager\n} from '@blueprintjs/core';\n\nFocusStyleManager.onlyShowFocusOnTabs();\n\nimport {\n  Component\n} from 'react';\n\nimport {\n  render\n} from 'react-dom';\n\nimport h from 'react-hyperscript';\n\nimport {\n  UIControls\n} from './ui-controls';\n\nimport {\n  FigureContainer\n} from './figure-container';\n\nimport {\n  AppStateManager,\n  AppStateContext\n} from './state-manager';\n\nimport {\n  TaskList\n} from './task-list';\n\nimport './main.styl';\n\nAppMain = (function() {\n  class AppMain extends Component {\n    renderMain() {\n      var marginTop, selectedTask, taskLists, toolbarEnabled, zoomLevel;\n      ({taskLists, selectedTask, zoomLevel, toolbarEnabled} = this.context);\n      marginTop = toolbarEnabled ? \"30px\" : null;\n      if (selectedTask != null) {\n        return h(FigureContainer, {\n          task: selectedTask,\n          zoomLevel,\n          marginTop\n        });\n      }\n      if (taskLists != null) {\n        return h(TaskList, {\n          runners: taskLists\n        });\n      }\n      return null;\n    }\n\n    render() {\n      return h('div#app-main', [h(UIControls), this.renderMain()]);\n    }\n\n  };\n\n  AppMain.contextType = AppStateContext;\n\n  return AppMain;\n\n}).call(this);\n\nApp = function() {\n  return h(AppStateManager, null, h(AppMain));\n};\n\nel = document.querySelector(\"#app\");\n\nrender(h(App), el);\n"]}